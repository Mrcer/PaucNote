# z变换

## z变换

z变换就是离散型的z变换

$$
y[n]=H(z)z^n
$$

$$
H(z)=\sum_{n=-\infty}^{\infty}h[n]z^{-n}
$$

若z为虚数（即$z=j\omega$），$H(s)$就对应$h[n]$的傅里叶变换。对一般的复变量z来说，$H(s)$就被称为$h[n]$的**z变换**，其中复变量z一般可写为$z=re^{j\omega}$，z变换可表示为算子形式$\mathcal{Z}(x[n])$，变换关系可表示为$x[n]\overset{\mathcal{Z}}{\rightarrow}X(s)$.

z变换可以看做是输入信号乘上一个衰减/增强信号$r^{-n}$后再做傅里叶变换的结果

同样，z变换有类似定义的收敛域ROC、零点、极点。对比离散型和连续型的频率响应，最大的区别在于离散型的输入本质上是连续型的输入经过指数复变换的结果，因此z平面可以理解为s平面的指数复变换。变换的相关过程可以去B站搜，总的来说，z平面的单位圆对应傅里叶变换（s平面的$j\omega$轴），单位圆外对应s平面的右半部分，单位圆内对应左半部分，零点对应实部负无穷，沿着s平面上下对应在z平面的某个圆内周期旋转（这也对应了离散型傅里叶变换的周期性）

## z变换收敛域

以下给出一些可以由表达式推收敛域的性质：

* X(s)的收敛域是z平面内以原点为中心的圆环
* 收敛域内不包含任何极点
* 如果x[n]是有限长序列，那么收敛域就是整个z平面，可能除去z=0和/或$z=\infty$
* 如果x[n]是右边序列，并且$|z|=r_0$的圆位于收敛域内，那么$|z|>r_0$的全部有限z值都一定在收敛域内
* 如果x[n]是左边序列，并且$|z|=r_0$的圆位于收敛域内，那么$|z|<r_0$的全部有限z值都一定在收敛域内
* 如果x[n]是双边信号，并且$|z|=r_0$的圆位于收敛域内，那么该收敛域在z平面中一定是包含$|z|=r_0$这一圆环的环形区域。
* 如果x[n]的z变换X(z)是有理的，那么它的收敛域是被极点所界定的或延伸到无限远。
* 如果x[n]的z变换X(s)是有理的，那么若x[n]是右边序列，则其收敛域在z平面上位于最外层极点圆的外边，而且若x[n]为因果序列，即n<0时全零的右边序列，则收敛域包含$z=\infty$；若x[n]是左边信号，则其收敛域在z平面上位于最内层极点圆的里边，而且若x[n]为反因果序列，即n>0时全零的左边序列，则收敛域包含$z=0$；

## z逆变换

$$
x[n]=\frac{1}{2\pi j}\oint X(s)z^{n-1}dz
$$

上式不好求，对于有理变换一般用类似前面的部分分式法求。书本还介绍了长除法和级数法，他们分别用长除式和泰勒展开，将分式展开为$a_0+a_1z^{-1}+a_2^2z^{-2}+\cdots$（这是右边信号的展开，左边信号要写成升幂形式），然后根据z变换的定义式直接得到h[n]

## 由零-极点图对傅里叶变换进行几何求值

与连续型类似，画从零/极点到积分区间的向量，然后分析模长和幅度，只不过这次积分区间是单位圆

## z变换的性质

设$x[n]\overset{\mathcal{Z}}{\rightarrow}X(z),ROC=R$,$x_1[n]\overset{\mathcal{Z}}{\rightarrow}X_1(z),ROC=R_1$,$x_2[n]\overset{\mathcal{Z}}{\rightarrow}X_2(z),ROC=R_2$

### 线性性质：

$$
ax_1[n]+bx_2[n]\overset{\mathcal{Z}}{\rightarrow}aX_1(z)+bX_2(z)
$$

收敛域包括$R_1\cap R_2$

### 时移性质：

$$
x[n-n_0]\overset{\mathcal{Z}}{\rightarrow}z^{-n_0}X(z)
$$

收敛域为R（除了可能增加或除去原点或无穷远）

### z域尺度变换

$$
e^{j\omega_0n}x[n]\overset{\mathcal{Z}}{\rightarrow}X(e^{j\omega_0}z)
$$

收敛域为R

$$
z_0^{n}x[n]\overset{\mathcal{Z}}{\rightarrow}X(\frac z {z_0})
$$

收敛域为$z_0R$

$$
a^nx[n]\overset{\mathcal{Z}}{\rightarrow}X(a^{-1}z)
$$

收敛域是R的尺度变换，相当于放大|a|倍（|a|<0同理）

### 时间反转

$$
x[-n]\overset{\mathcal{Z}}{\rightarrow}X(z^{-1})
$$

收敛域为$R^{-1}$，这个复变换以单位圆为不动区域，圆内外翻转，然后绕原点旋转180度。

### 时域扩展

$$
x_{(k)}[n]=\left\{\begin{aligned}&x[n/k],&n为k的倍数\\&0,&n不为k的倍数\end{aligned}\right.
$$

与之前定义一致，k为正整数，相当于内插(k-1)个零

$$
x_{(k)}[n]\overset{\mathcal{Z}}{\rightarrow}X(z^k)
$$

收敛域为$R^{1/k}$，也就是模长上点向单位圆靠拢，辐角上收缩。

### 共轭

$$
x^*[n]\overset{\mathcal{Z}}{\rightarrow}X^*(z^*)
$$

收敛域为R

### 卷积

$$
x_1[n]*x_2[n]\overset{\mathcal{Z}}{\rightarrow}X_1(z)X_2(z)
$$

收敛域包括$R_1\cap R_2$

### 一次差分

$$
x[n]-x[n-1]\overset{\mathcal{Z}}{\rightarrow}(1-z^{-1})X(z)
$$

收敛域包括R（可能不包括零点）

### 累加

$$
\sum_{k=-\infty}^n x[k]\overset{\mathcal{Z}}{\rightarrow}\frac 1 {1-z^-1} X(z)
$$

收敛域至少为$R\cap\{|z|>1\}$

### z域微分

$$
nx[n]\overset{\mathcal{Z}}{\rightarrow}-z\frac {dX(z)} {dz}
$$

收敛域为R

### 初值定理

若n<0时,x[n]=0，则$x[0]=\lim_{z\to \infty}X(z)$

## 常用z变换对

| 信号                       | 变换                                                                   | 收敛域                                |
| -------------------------- | ---------------------------------------------------------------------- | ------------------------------------- |
| $\delta[n]$              | 1                                                                      | 全部z                                 |
| $u[n]$                   | $\frac{1}{1-z^{-1}}$                                                 | $\mid z\mid>1$                      |
| $-u[-n-1]$               | $\frac{1}{1-z^{-1}}$                                                 | $\mid z\mid<1$                      |
| $\delta[n-m]$            | $z^{-m}$                                                             | 全部z，除去零（若m>0）或无穷（若m<0） |
| $a^nu[n]$                | $\frac{1}{1-az^{-1}}$                                                | $\mid z\mid>\mid a\mid$             |
| $-a^nu[-n-1]$            | $\frac{1}{1-az^{-1}}$                                                | $\mid z\mid<\mid a\mid$             |
| $na^nu[n]$               | $\frac{az^{-1}}{(1-az^{-1})^2}$                                      | $\mid z\mid>\mid a\mid$             |
| $-na^nu[-n-1]$           | $\frac{az^{-1}}{(1-az^{-1})^2}$                                      | $\mid z\mid<\mid a\mid$             |
| $\cos(\omega_0n)u[n]$    | $\frac{1-(\cos\omega_0)z^{-1}}{1-2(\cos\omega_0)z^{-1}+z^{-2}}$      | $\mid z\mid>1$                      |
| $\sin(\omega_0n)u[n]$    | $\frac{(\sin\omega_0)z^{-1}}{1-2(\cos\omega_0)z^{-1}+z^{-2}}$        | $\mid z\mid>1$                      |
| $r^n\cos(\omega_0n)u[n]$ | $\frac{1-r(\cos\omega_0)z^{-1}}{1-2r(\cos\omega_0)z^{-1}+r^2z^{-2}}$ | $\mid z\mid>r$                      |
| $r^n\sin(\omega_0n)u[n]$ | $\frac{r(\sin\omega_0)z^{-1}}{1-2r(\cos\omega_0)z^{-1}+r^2z^{-2}}$   | $\mid z\mid>r$                      |

## 用z变换分析与表征线性时不变系统

一般将$H(s)$称为系统函数或传递函数

### 因果性

一个离散线性时不变系统是因果的当且仅当它的系统函数的收敛域是某个圆的外边且包括无穷远。对于一个具有有理系统函数的系统来说，系统的因果性就等效于收敛域位于最外层极点外边某个圆的外边，且若H(z)表示成z的多项式之比，其分子的阶次不能高于分母的阶次。

### 稳定性

当且仅当系统函数$H(s)$的收敛域包括单位圆时，线性时不变系统是稳定的

当且仅当系统函数的全部极点都位于单位圆内，即极点的模均小于1时，一个具有有理系统函数的因果系统才是稳定的

## 系统函数的代数属性与方框图表示

与连续型道理一样，不再赘述

## 单边z变换

单边z变换定义为

$$
X(s)=\sum_{n=0}^{+\infty} x[n]z^{-n}
$$

之所以引入单边z变换，是因为它可以用来解带初始条件的差分方程：

单边z变换的时延性质为

$$
x[n-1]\overset{\mathcal{UZ}}{\rightarrow}z^{-1}\chi(z)+x[-1]
$$

可以发现引入了常量x[-1]，如此，对具有y[n-1]的差分方程两边求单边z变换，就会有常量y[-1]出现，从而可以求解带有初始条件的差分方程。

> 双边变换求解差分方程利用了线性时不变系统的假设，包括了初始松弛的假设。单边变换求解的差分方程相当于求解了增量线性系统，其解包括零状态响应加上一个零输入响应。
