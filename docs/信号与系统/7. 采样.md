# 采样

## 用信号样本表示连续时间信号

### 冲激串采样

**冲激串采样**就是用一个周期冲激串去乘带采样的连续信号，其中冲激串$p(t)$称为**采样函数**，周期$T$称为**采样周期**，而$p(t)$的基波频率$\omega_s=2\pi/T$称为采样频率

由于时域相乘对应频域卷积，而冲激串的频域也是冲激串，因此频域上相当于将待采样信号“变得周期性”，如果待采样信号频域足够窄，使得周期化后信号“不互相重叠”，那么就无损地采样了信号。这被称为**采样定理**：

设$x(t)$是某一个带限信号，在$|\omega|>\omega_M$时，$X(j\omega)=0$。如果$\omega_s>2\omega_M$，其中$\omega_s=2\pi/T$，那么$x(t)$就唯一地由其样本$x(nT),n=0,\pm 1,\pm 2,\cdots$所确定。在采样定理中，采样频率必须大于$2\omega_M$，该频率一般称为**奈奎斯特速率**

已知这些样本值，就能用一个增益为$T$，截止频率大于$\omega_M$而小于$\omega_s-\omega_M$的理想低通滤波器还原信号

### 零阶保持采样

由于产生和传输窄而幅度大的脉冲（冲激的近似）难度很大，因此往往用**零阶保持**方式来产生采样信号。具体来说，对被采样信号周期性地采样并保持这一样本值，直到下一个样本被采到为止。重建信号的方式依然是使用低通滤波器，但增益不是恒等的。一般来说零阶保持采样信号已经可以看作是原信号的一种近似，不需要再设计复杂的滤波器还原。

## 利用内插由样本重建信号

内插（也就是用一个连续信号对一组样本值的拟合）是一个由样本值来重建某一函数的常用过程。直接将样本值用直线连起来的**线性内插**是一种常见内插。用理想低通滤波器还原冲激串采样就是一种内插，称为**带限内插**。零阶采样是一种近似的内插，为了得到更精确的内插，可以尝试**高阶内插**，也就是保持导数以及更高阶的导数连续。

## 欠采样的效果：混叠现象

如果采样频率没有大于奈奎斯特速率，采样出来的信号频谱中，原信号的频谱会出现重叠，导致不能用理想低通滤波器还原原信号，这种现象被称为**混叠**

出现混叠时，原始频率$\omega_0$就被混叠成一个较低的频率$(\omega_s-\omega_0)$。对于$\omega_s/2<\omega_0<\omega_s$，随着$\omega_0$相对于$\omega_s$的增加，输出频率$\omega_s-\omega_0$就会下降，当$\omega_s=\omega_0$时，被重建的信号就是一个常数。有时，混叠会导致滤波后原频谱的一部分正负互换，呈现**相位倒置**的现象。这些可以通过观察带频闪的日光灯下的电扇扇叶直观感受：在不同转速下，扇叶有时变快，有时变慢到静止，有时甚至倒转。以此为原理可以制造采样示波器

值得注意的是采样频率不能等于奈奎斯特速率，可以考虑以$\pi$为周期采样$\sin t$，会得到全零的信号，自然还原不出原信号。

## 连续时间信号的离散时间处理

为了方便数字系统处理现实中的信号，一般要把传感器得到的连续信号转换成离散信号，处理器处理完后再转换为离散信号，实现这两个功能的组件分别称为**模数转换器（ADC）**和**数模转换器（DAC）**。

记连续输入为$x_c(t)$，离散化后为$x_d[n]$，处理后的离散输出为$y_d[n]$，连续化后为$y_c(t)$，那么有如下关系：

$$
x_d[n]=x_c(nT)
$$

$$
y_d[n]=y_c(nT)
$$

因此模数转换本质就是对连续信号冲激采样后进行了时间归一化，以$x_p(t)$和$X_p(j\omega)$表示冲激采样后的信号和频谱，T为采样周期，则

$$
X_d(e^{j\Omega})=X_p(j\Omega/T)=\frac{1}{T}X_c(j(\Omega-2\pi k)/T)
$$

从频谱上来看，$X_p$将$X_c$在$\omega$轴上以$2\pi /T$为周期复制，在幅度上乘上了$1/T$；$X_d$将$X_p$扩展了T倍，使得周期变为$2\pi$；在经过离散系统处理后，用逆变换变回冲激串，再用低通滤波器变成输出信号。

采样频率一般需要满足采样定理，或者至少不能出现混叠现象

## 离散信号采样

与连续型采样类似，离散采样将原信号乘上间隔脉冲串，得到

$$
x_p[n]=\left\{\begin{aligned}&x[n],&若n为N的整数倍\\&0,&其他\end{aligned}\right.
$$

$x_p$有大量的零，为了便于表达、传输和存储，一般要进行**抽取**，去掉这些零：

$$
x_b[n]=x_p[nN]=x[nN]
$$

从频域上看，他们关系如下：

$$
X_b(e^{j\omega})=X_p(e^{j\omega/N}),X_p(e^{j\omega})=\frac{1}{2\pi}\int_{2\pi}P(e^{j\theta})X(e^{j(\omega-\theta)})d\theta
$$

其中P为冲激串

如果原离散信号是从连续信号采样来的，且经过离散采样依然没有发生混叠，那么就相当于对连续信号以更低频率采样，于是就称为**减采样**；同样，在离散信号中插入零，然后过个低通滤波器，得到更多采样信号，这就被称为**增采样**或**内插**
