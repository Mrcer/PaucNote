# 假设验证
## 基本概念
对于一个已知分布的总体和它的一个样本$X_1,X_2,\cdots,X_n$，给出对于总体中参数的假设$H_0$和它的反面$H_1$，前者被称为**原假设**或**零假设**，后者被称为**备择假设**。

**显著性判断**：构造出原假设成立时样本特征的统计量，称为**检验统计量**，取一个小概率值$\alpha$作为拒绝原假设的界限，这个概率被称为**显著性水平**，算出概率小于显著性水平的统计量取值区域，这个区域C就被称为**拒绝域**，拒绝域的边界点被称为**临界点**。

> 拒绝原假设只是说这个样本太不显著了，在假设成立的情况下发生的可能很小；接受原假设也只是说样本足够显著，还没有到足以否定原假设的程度。

对假设的判断有两种错误：拒绝实际为真的原假设，称为**第一类错误**或**弃真错误**；接受实际为假的原假设，称为**第二类错误**或称**取伪**错误。由于显著性判断基于原假设成立，因此只控制了第一类错误发生的概率。一般来说，在样本容量确定时，一种错误发生的概率控制得越小，另一种错误发生的概率往往越大。

以均值$\mu$为例提出假设，如果备择假设为$\mu\neq\mu_0$，则这次检验被称为**双边假设检验**；如果备择假设为$\mu>\mu_0$，则称为**右边检验**；如果备择假设为$\mu<\mu_0$，则称为**左边检验**。左边检验和右边检验统称为**单边检验**。

## 正态分布均值、方差的检验法（显著性水平为$\alpha$）

| |原假设$H_0$|检验统计量|备择假设$H_1$|拒绝域|
|-|:--------:|:--------:|:----------:|:----:|
|1|$\mu\leq\mu_0$<br>$\mu\geq\mu_0$<br>$\mu=\mu_0$<br>（$\sigma^2$已知）|$$Z=\frac{\overline X-\mu_0}{\sigma/\sqrt n}$$|$\mu>\mu_0$<br>$\mu<\mu_0$<br>$\mu\neq\mu_0$<br>|$z\geq z_\alpha$<br>$z\leq -z_\alpha$<br>$\vert z\vert\geq z_{\alpha/2}$|
|2|$\mu\leq\mu_0$<br>$\mu\geq\mu_0$<br>$\mu=\mu_0$<br>（$\sigma^2$未知）|$$t=\frac{\overline X-\mu_0}{S/\sqrt n}$$|$\mu>\mu_0$<br>$\mu<\mu_0$<br>$\mu\neq\mu_0$|$t\geq t_\alpha(n-1)$<br>$t\leq -t_\alpha(n-1)$<br>$\vert t\vert \geq t_{\alpha/2}(n-1)$|
|3|$\mu_1-\mu_2\leq\delta$<br>$\mu_1-\mu_2\geq\delta$<br>$\mu_1-\mu_2=\delta$<br>（$\sigma_1^2,\sigma_2^2$已知）|$$Z=\frac{\overline X-\overline Y-\delta}{\sqrt{\sigma_1^2/n_1+\sigma_2^2/n_2}}$$|$\mu_1-\mu_2>\delta$<br>$\mu_1-\mu_2<\delta$<br>$\mu_1-\mu_2\neq\delta$|$z\geq z_\alpha$<br>$z\leq-z_\alpha$<br>$\vert z\vert \geq z_{\alpha/2}$|
|4|$\mu_1-\mu_2\leq\delta$<br>$\mu_1-\mu_2\geq\delta$<br>$\mu_1-\mu_2=\delta$<br>（$\sigma_1^2=\sigma_2^2=\sigma^2$已知）|$$t=\frac{\overline X-\overline Y-\delta}{S_w\sqrt{1/n_1 +1/n_2}}$$ $$S_w^2=\frac{(n_1-1)S_1^2+(n_2-1)S_2^2}{n_1+n_2-2}$$|$\mu_1-\mu_2>\delta$<br>$\mu_1-\mu_2<\delta$<br>$\mu_1-\mu_2\neq\delta$|$t\geq t_\alpha(n_1+n_2-2)$<br>$t\leq -t_\alpha(n_1+n_2-2)$<br>$\vert t\vert \geq t_{\alpha/2}(n_1+n_2-2)$|
|5|$\sigma^2\leq\sigma^2_0$<br>$\sigma^2\geq\sigma^2_0$<br>$\sigma^2=\sigma^2_0$<br>（$\mu$未知）|$$\chi^2=\frac{(n-1)S^2}{\sigma_0^2}$$|$\sigma^2>\sigma^2_0$<br>$\sigma^2<\sigma^2_0$<br>$\sigma^2\neq\sigma^2_0$|$\chi^2\geq\chi_\alpha^2(n-1)$<br>$\chi^2\leq\chi_{1-\alpha}^2(n-1)$<br>$\chi^2\geq\chi_{\alpha/2}^2(n-1)$或<br>$\chi^2\leq\chi_{1-\alpha/2}^2(n-1)$|
|6|$\sigma_1^2\leq\sigma_2^2$<br>$\sigma_1^2\geq\sigma_2^2$<br>$\sigma_1^2=\sigma_2^2$<br>（$\mu_1,\mu_2$未知）|$$F=\frac{S_1^2}{S_2^2}$$|$\sigma_1^2>\sigma_2^2$<br>$\sigma_1^2<\sigma_2^2$<br>$\sigma_1^2\neq\sigma_2^2$|$F\geq F_\alpha(n_1-1,n_2-1)$<br>$F\leq F_{1-\alpha}(n_1-1,n_2-1)$<br>$F\geq F_{\alpha/2}(n_1-1,n_2-1)$或<br>$F\leq F_{1-\alpha/2}(n_1-1,n_2-1)$|
|7|$\mu_D\leq 0$<br>$\mu_D\geq 0$<br>$\mu_D=0$<br>（成对数据）|$$t=\frac{\overline D-0}{S_D/\sqrt n}$$|$\mu_D> 0$<br>$\mu_D< 0$<br>$\mu_D\neq 0$|$t\geq t_\alpha(n-1)$<br>$t\leq -t_\alpha(n-1)$<br>$\vert t\vert \geq t_{\alpha/2}(n-1)$|

对上表的解释：

1. 一个正态分布，方差已知验证均值，使用**Z检验法**
2. 一个正态分布，方差未知验证均值，使用**t检验法**
3. 两个正态分布，方差已知验证均值差，使用Z验证法
4. 两个正态分布，方差相等但未知，验证均值差，使用t检验法
5. 一个正态分布，验证方差，使用$\chi^2$**检验法**
6. 两个正态分布，验证方差谁大谁小，使用**F检验法**。两总体方差相等也称两总体具有**方差齐性**
7. 用两个机器在相同条件下进行对比试验，测出n对数据，他们的差值记为D，假设D服从正态分布，就可以排除标准样本差异根据**t验证法**判断机器的系统误差，这种方法叫**逐对比较法**（第二种情况的应用）

> 检验统计量是什么就叫什么检验法

## 分布拟合检验
### 单个分布的卡方拟合检验法
设总体X的分布未知，$x_1,x_2,\cdots,x_n$是来自X的样本值，要检验的原假设为总体X的分布函数为F(x)，这个分布函数不含未知参数。假设的分布函数也可以用分布律或概率密度代替。

接下来定义检测统计量。将在$H_0$下X可能取值的全体$\Omega$分成互不相交的子集$A_1,A_2,\cdots,A_k$，以$f_i(i=1,2,\cdots,k)$记样本观察值$x_1,x_2,\cdots,x_n$中落在$A_i$的个数，并记$p_i=P(A_i),i=1,2,\cdots,k$。我们取以下统计量作为检验统计量

$$\chi^2=\sum_{i=1}^k\frac{n}{p_i}\left(\frac{f_i}{n}-p_i\right)^2=\sum_{i=1}^k\frac{n}{np_i}-n$$

可以证明当n充分大（大于等于50）时其近似服从$\chi^2(k-1)$分布。

当原假设成立时，卡方不应过大。对于给定的显著性水平$\alpha$，拒绝域为

$$\chi^2\ge \chi^2_\alpha(k-1)$$

这就是单个分布的$\chi^2$**拟合检验法**。需要注意的是除了需要满足$n\ge 50$，还需要满足$np_i\ge 5$，如果不满足就需要适当合并$A_i$以满足条件。
### 分布族的$\chi^2$拟合检验
通常待检验的分布都是含未知参数的，不同的未知参数可以确定不同分布，这被称为分布族。

为了检验总体是否符合某一分布族，先假设其属于，用参数估计法（如最大似然估计）求出未知参数的估计值，然后代入求出$p_i$的估计值$\hat p_i$，并用估计值代替上面统计量的$p_i$，即

$$\chi^2=\sum_{i=1}^k\frac{n}{n\hat p_i}-n$$

可以证明，在某些条件下，原假设为真时其满足$\chi^2(k-r-1)$分布，其中r为未知参数的数量。也就是拒绝域为

$$\chi^2\ge \chi^2(k-r-1)$$

需要注意的是，除了要满足$n\ge 50$、$np_i\ge 5$，还要保证$k>r+1$，也就是可能取值的子集划分数量要大于r+1.
##  假设检验问题的p值法

前面的检验法都是引入$\alpha$来决定是否接受原假设，这被称为**临界值法**。由于$\alpha$的选取具有一定的任意性，不能准确反映接受程度，于是引入p值检验法。

假设检验问题的p值是由检验统计量的样本观察值得出的原假设可被拒绝的最小显著性水平。具体来说，就是把之前检验法中通过显著性水平求拒绝域边界的过程，替换成通过统计量观察值求p值——比如，在已知方差的情况下检验正态分布的均值，若为单边假设检验，p值等于$z_0$界定的尾部面积；若为双边假设检验，p值等于两倍由$z_0$界定的尾部面积。其中$z_0$为统计量Z的观察值。求出p值后，对于任意给定的显著性水平$\alpha$，若p值小于等于$\alpha$则拒绝原假设，否则接受原假设。这就是**p值法**
