# 图的基础知识
## 图的基本概念
* （定义9.1）**无向图** 是二元组`G＝(V,E)`，其中V是非空集，称为图的**顶点集**，它的元素称为G的**顶点**(vertex)或节点；E称为图的**边集**，它的元素称为G的**边**(edge)，且每条边$e\in E$，都**关联**两个顶点u和v，这两个顶点称为边e的两个**端点**，也称边e连接这两个端点，通常将边e记为`e=(u,v)`或`e=(v,u)`

* （定义9.1）**有向图** 是二元组`G＝(V,E)`，非空集V是图的顶点集，它的元素称为G的顶点或节点；E是图的边集，它的元素称为G的**有向边**，且每条边都有一个顶点u作为它的**起点**，还有一个顶点v作为它的**终点**，通常记为`e=<u,v>`。有向图的**基图**是不考虑边的方向而得到的无向图。

* 如果一个图既有有向边又有无向边，则这个图称为**混合图**，本章不研究。
* 一些特殊的图：
    * 含有n个顶点的图称为**n阶图**
    * 不含边的图称为**零图**
    * 只有一个顶点的图称为**平凡图**
    * 顶点集为空集的图称为**空图**
    * 使用符号标记了顶点和边的图称为**标定图**
* （定义9.3）对于图：
	* 若e连接顶点u,v，则称e **关联** u和v
	* 若u,v间有边则称u与v **邻接**，若进一步区分u是起点v是终点，则可称u **邻接到** v而v **邻接与** u
	* 若两条边关联同一个顶点，则称这两边**邻接**

* （定义9.4）对于图：
	* **环**是关联同一个顶点的边
	* **重边**是关联顶点相同的两条边（有向边的起点终点要相同）
	* **简单图**是不含环和重边的图

* （定义9.5）
	* 对于无向图 $G=(V,E)$ 中的一个顶点$v\in V$，v的**度数**d(v)是关联v的边的条数，其中关联v的环要计算两遍
	* 对于有向图，进一步区分**入度**$d^-(v)$等于以v为终点的有向边条数，**出度**$d^+(v)$等于以v为起点的有向边条数，度数等于入度和出度之和

* 无向图中度数为一的顶点称为**悬挂顶点**，与悬挂顶点关联的边称为**悬挂边**。度数为0的顶点称为**孤立顶点**

* （定理9.1）**握手定理**：无向图中所有顶点的度数之和等于边数的两倍$\sum_{d\in V}d(v)=2|E|$；有向图中所有顶点的出度和等于入度和等于边数$\sum_{d\in V}d^-(v)=\sum_{d\in V}d^+(v)=|E|$。

* **奇度顶点**是度数为奇数的顶点，**偶度顶点**是度数为偶数的顶点
* （推论9.2）任何图的奇度顶点个数是偶数
* （定义9.6）**最小度** $\delta(G)$ 等于度数最小的顶点的度数；**最大度**$\Delta(G)$等于度数最大的顶点的度数
* （定义9.7）**k正则图**是任意顶点度数都等于k的图；**完全图**是任意两个顶点间都有边的*简单图*；特别地，有n个顶点的完全图被称为n阶完全图，记为$K_n$
* 更多特殊的图：
  	* **圈**是按序号首尾相连的简单图
  	* **轮图**是在圈的基础上增加一个邻接所有其他顶点的顶点
  	* **立方体图**$Q_n$是具有$2^n$个顶点的图，其中每个顶点可用二进制编号，使得两个顶点有边当且仅当他们的二进制编号只有一位不同
  	* **二部图**是顶点集可被划分为两个部分$V_1$和$V_2$，使得每个部分内的点互不关联的图，二部图也称**偶图**或**二分图**，它对顶点集的划分称为**二部划分**（定义9.8）
  	* **完全二部图**是$V_1$的任意顶点和$V_2$的任意顶点都恰有一边相连的二部图

* （定义9.9）如果G'=(V',E')的顶点集和边集都是G=(V,E)对应集的子集，则称G'是G的**子图**；特别地，如果V'=V，则称G'是G的**生成子图**；如果子图缺少的边都是因为缺少顶点造成的，也就是$E'=\{e\in E | e=(u,v)且u\in V'且v\in V'\}$，则称G'是G的**导出子图**

* 一些对图的操作
	* **删除顶点集**G-V'：删除包含在V'中的顶点，并移除关联这些顶点的边
	* **删除边集**G-E'：删除包含在E'中的边
	* **删除子图**G-G'：删除G在其子图G'中的所有边
	* **边的收缩**G\e：删除e并合并e关联的两个顶点（合并指的是用新顶点代替原来两个顶点，新顶点关联原来两个顶点关联的所有边）
	* **添加新边**G+(u,v)：字面意思
* n解简单图G的**补图**$\bar G=K_n-G$
* （定义9.11）对于图$G=(V,E)$和 $G'=(V',E')$ ，如果存在双函数 $f:V\to V'$ ，满足：对E的任意边$e=(u,v)$，E'存在唯一的边 $e'=(f(u),f(v))$ ，而且对E'的任意边 $e'=(u',v')$，E存在唯一的边$e=(f^{-1}(u'),f^{-1}(v'))$ ，则称G和G'同构，记为G~G'

### 图的连通性

* （定义9.12）对无向图G：
    * **通路**$\Gamma=v_0e_1v_1e_2\cdots e_nv_n$是G的顶点和边的交替序列，且对任意$1\leq i\leq n$有$e_i=(v_{i-1},v_i)$。这时称$v_0$和$v_n$是$\Gamma$的两个端点，n是$\Gamma$的长度。如果还满足$v_0=v_n$，则称$\Gamma$是**回路**
    * **简单通路**或**简单回路**中“简单”指不含重复边
    * **初级通路**或**初级回路**中“初级”指不含重复顶点
    * 初级通路又称**路径**，初级回路又称**圈**

* （定义9.13）对于有向图，**有向通路**相当于在无向图的通路基础上加入方向性，其他有向定义类似
* （引理9.3）对于有n个顶点的图，若u,v间存在通路，则u,v间一定存在以u,v为端点的长度小于等于n-1的初级通路
* （推论9.4）对于有n个顶点的图，若u存在到其自身的回路，则一定存在从u到其自身的长度小于等于n的初级回路
* （定义9.14）对于无向图G，若u,v间存在通路，则称他们是**可达的**，并约定顶点到其自身是可达的；在V上定义关系$\leftrightarrow\subseteq V\times V$，$u\leftrightarrow v$当且仅当u和v是可达的，则$\leftrightarrow$是等价关系，称V关于$\leftrightarrow$的等价类$[u]_\leftrightarrow\subseteq V$导出的子图为G的**连通分支**，一般记G的连通分支数为$p(G)$。若p(G)=1，则称G是**连通无向图**，或连通图。
* （引理9.5）设无向图G(V,E)是简单图，|V|=n，|E|=m。若G是连通图，则$m\geq n-1$
* （定义9.15）设G=(V,E)是无向图，$V'\subset V$是顶点集V的真子集，若V'满足：
    1. G-V'的连通分支比G多
    2. 只删除V'中的某些顶点及关联的边不会增加图的连通分支数  
则称V'是图的**点割集**。若点割集只有一个顶点，则称该顶点为**割点**

* （定义9.16）设G(V,E)是连通无向图，|V|=n，且完全图$K_n$不是G的子图。将图G的顶点数最少的点割集的顶点数称为它的**点连通度**，简称**连通度**，记为$\kappa(G)$。约定完全图$K_n$的点连通度为n-1，非连通图的点连通度为0，。若$\kappa(G)\geq k$，则称G是k连通图

* （定义9.15）设G=(V,E)是无向图，$E'\subset E$是边集E的真子集，若E'满足：
    1. G-E'的连通分支比G多
    2. 只删除E'中的某些边不会增加图的连通分支数  
则称V'是图的**边割集**。若边割集只有一条边，则称该。为**割边**，或**桥**。

* （定义9.16）设G(V,E)是连通无向图。将图G的边数最少的边割集的边数称为它的**边连通度**，记为$\lambda(G)$。约定非连通图的边连通度为0，。若$\lambda(G)\geq r$，则称G是r边连通图

* （定义9.19）设G=(V,E)是有向图，u和v是G的两个顶点，若存在以u为起点，v为终点的有向通路，则称u**可达**v，记为$u\to v$。进一步记$u\to v$且$v\to u$为$u\leftrightarrow v$。约定总有$u\leftrightarrow u$。
* 若有向图G中任意两个顶点u,v都有$u\leftrightarrow v$，则称G是**强连通有向图**；若有向图G中任意两个顶点u,v至少有$u\to v$或$v\to u$之一成立，则称G是**单向连通图**；若有向图G的基图是无向连通图，则称G是**弱连通图。

* 有向图G是强连通的当且仅当G存在经过每个顶点至少一次的有向回路

### 图的表示与储存
* （定义9.20）设G=(V,E)是有向图，其中$V=\{v_1,v_2,\cdots,v_n\}$,$E=\{e_1,e_2,\cdots,e_m\}$。则G的**关联矩阵**$M=[m_{ij}]$是$n\times m$的矩阵，对任意的$1\leq i\leq n,1\leq j\leq m$有：

$$
m_{ij}=\left\{
\begin{aligned}
&1	&若v_i是e_j的起点\\
&-1	&若v_i是e_j的终点\\
&0	&否则
\end{aligned}
\right.
$$

类似地，无向图G的**关联矩阵**$M=[m_{ij}]$定义为：若$v_i$是$e_j$的端点则$m_{ij}=1$，否则$m_{ij}=0$

> 也就是说关联矩阵每一列都是一条边，对应行表示该边是否与某顶点关联等

* （定义9.21）设G=(V,E)是有向图，其中$V=\{v_1,v_2,\cdots,v_n\}$。G的**邻接矩阵**$A=[a_{ij}]$是$n\times n$的矩阵，对任意$1\leq i \leq n$,$1\leq j\leq n$，有：

$$
a_{ij}=以v_i为起点、v_j为终点的有向边的条数
$$

类似地，无向边G的**邻接矩阵**$A=[a_{ij}]$定义为：$a_{ij}$是以v_i和v_j为端点的无向边条数。

* 对G的邻接矩阵A，使用普通的矩阵乘法得到的$A^k$表示G的任意两个顶点之间的长度为k的（有向）通路条数

* 令矩阵$B=\sum_{i=1}^{n-1}A^i$，则B的元素$b_{ij}$给出顶点$v_i$和$v_j$之间长度不超过n的（有向）通路条数。定义**可达矩阵**$P=[p_{ij}]$，对角线均为1（顶点到自己总是可达的），其余位置若$b_{ij}\geq 1$则$p_{ij}=1$。

* **邻接表**可以用来表示一个简单有向图或简单无向图。若一个简单有向图有n个顶点，则它的邻接表有n行，每一行给出一个顶点的邻接顶点列表，即以这个顶点为起点的有向边的终点的列表。类似地，如果一个简单无向图有n个顶点，它的邻接表也是n行，每一行给出一个顶点的邻接顶点列表，即以这个顶点为一个端点的无向边的另一个端点的列表。
### 无向图的遍历
* 图的**遍历**或称**搜索**是指从图的某个顶点出发，沿着一些边访问所有顶点；遍历有两种思路：**深度优先搜索**（先深搜索）和**广度优先搜索**（先广搜索）
* 深搜需要用栈（后进先出）S记录已经访问过且需要回溯的顶点序列，用集合T记录所有访问过的顶点。算法从往T和S中加入一个起始点开始，不断地尝试沿着S的栈顶顶点的边找其邻接且不在T的顶点，如果找到了就入栈并将新顶点记录到T中，否则栈顶顶点出栈，这样一直持续到栈被清空；如果图中还有顶点未加入T（非连通图才会出现），则随便找个未加入T的顶点加入T和S重复算法。实际实现中可以用递归算法实现，算法复杂度为$O(n^2)$。
* 广搜需要用队列（先进先出）Q记录尚未访问过其所有相邻顶点的顶点，用集合T记录所有访问过的顶点。算法从往T和Q中加入一个起始点开始，不断地从队列中取出顶点并访问其所有邻接顶点，将访问到的未加入T的顶点加入T和Q，如此重复直到队列清空；如果图中还有顶点未加入T就随便选一个未加入T的放入T和Q。算法复杂度为$O(n^2)$
## 树的基础知识
### 无向树的定义
* （定义9.22）连通且没有回路的简单无向图称为**无向树**。无向树中度数为1的顶点成为**树叶**，度数大于或等于2的顶点称为**分支点**。只有一个顶点的简单图称为**平凡树**。含有多个无回路的连通分支的简单无向图称为**森林**
* （定理9.7、9.8）设简单无向图G有n个顶点m条边，以下命题等价：
	1. G是树
	2. G的任意两个顶点之间存在唯一的通路
	3. G连通且任意边都是桥
	4. G无回路，但在任意两个不相邻顶点之间加一条新边，则得到唯一一个且含新边的回路
	5. G无回路且m=n-1
	6. G连通且m＝n-1
### 根树的定义
* （定义9.23）若一个有向图的基图是树，则称这个图是**有向树**。若有向树T有且仅有一个顶点r的入度为0，则称T是以r为**根**的**根树**。我们也将根树中的顶点称为**节点**。根树中出度为0的顶点称为**叶子**，出度不为0的顶点称为**内部顶点**
* （引理9.9）设T=(V,E)是以顶点r为根的根树，且$|V|>1$，则除r以外的顶点入度都为1。进一步，r到任意其他顶点都有唯一的有向通路
* （定义9.24）设T＝(V,E)是根树，u,v是T的两个顶点。若存在有向边$e=\langle u,v\rangle\in E$则称u是v的**父亲**，而v是u的**儿子**；如果顶点u和v有相同的父亲，则称u是v的**兄弟**。若存在u到v的一条有向通路，则称u是v的**祖先**，而v是u的**后代**。T的顶点u及其所有后代顶点导出的T的子图称为T的以u为根的**子树**。设T的根式r，则对T的任意顶点u，从r到u的唯一通路的长度称为u的**层数**。定义T的**高度**是从r到T的叶子的最长通路的长度
* （定义9.25）如果根树T的每个顶点的出度都不大于m，则称T是**m元树**；如果每个顶点的出度不是0就是m，则称T是**满m元树**或**正则m元树**。如果满m元树T的每片叶子的层数都等于树高，则称T是**完全m元树**。如果高度为h的m元树T的每片叶子要么是h，要么是h－1，则称T是**平衡m元树**
* 如果一棵树的每个顶点的儿子顶点都按照某个顺序排列，则称这棵根树为**有序根树**。有序二元树通常就称为**二元树**或**二叉树**，它的每个顶遍历点的第一个儿子通常称为**左儿子**，第二个儿子通常称为**右儿子**。以左儿子为根的子树称为**左子树**，以右儿子为根的子树称为**右子树**。
### 树的遍历
树的遍历一般从根开始，可采用先深或先广。

* 先广遍历在树中其实就是一层层往下遍历
* 先深遍历分前序、中序和后序
	1.  前序顶点入栈后先执行操作再继续深入
	2. 中序则是入栈后先遍历第一个儿子再执行操作最后遍历其他儿子
	3. 后序是顶点入栈后先遍历完所有儿子（也就是出栈前）再执行操作。
* 对于抽象语法树，对其进行前序、中序和后序遍历输出可分别得到表达式的**前缀**、**中缀**和**后缀**形式。表达式的前缀形式也称为**波兰记号**，后缀形式也称为**逆波兰记号**
## 带权图及其应用
### 带权图的最短距离
* （定义9.26）**带权有向图**就是每条有向边都被赋一个非负实数作为边的权的简单有向图
* （定义9.27）带权有向图的**距离矩阵**是一个n阶方阵，定义类似于可达矩阵，第i行第j列表示第i个顶点到第j个顶点的边的权（若没有边则为正无穷）
* 有向路径的**带权同路长度**等于构成通路边的权之和，v到u的最小的带权通路长度最短的通路称为v到u的**最短通路**，该通路长度称为v到u的**最短距离**
> 在定义9.26简单图和非负边权的条件下，最短通路又被称为**最短路径**
* （定理9.12）若$v_1,\cdots,k_{k-1},v_k$是$v_1$到$v_k$的最短路径，则$v_1,\cdots,v_{k-1}$是$v_1$到$v_{k-1}$的最短路径
* **最短路径的Djikstra算法**  
	定义三个集合或数组：  
        1. S记录尚未求得最短路径的顶点的集合  
        2. U是以顶点编号为下标的数组，$u_i$表示$v_1$到$v_i$的最短距离  
        3. Q是以顶点编号为下标的数组，$q_i$表示$v_1$到$v_i$的最短通路的直接前驱结点编号（也就是到终点前的一个顶点）  

	算法过程：  
		1. 初始化：最开始只有$v_1$已求得最短路，也就是S包含$v_1$以外的所有顶点（为了实现方便，v_1暂时也归入S），$u_1=0$，U的其他项为无穷  
		2. 更新最短路：从S中的顶点中选择其在U中记录的最短距离最小的顶点$v_x$（特别地，第一次更新必然取得$v_1$），将其从S中取出，并利用该顶点中转尝试更新其他顶点的最短路（术语*松弛*），也就是对于所有尚未确定最短路的顶点$v_y$，如果$u_x+d_{xy}<u_y$，更新$u_y$和$q_y$  
		3. 重复过程2，直到S中没有元素

	算法分析：  
	1. 该算法可以根据给定的简单带权有向图和某一给定起点，求出该起点到其他任意点的最短路径和对应最短距离  
	2. 算法复杂度在不优化的情况下为$O(n^2)$  
	3. 算法有效性证明思路是对于任意时间点，先证明S中的顶点对应记录的最短路必然是在利用已确定最短路的顶点为中间顶点情况下的最短路（用归纳法），再证明第二步中选出的顶点必然已确定最短路（用反证法）即可
### 带权图的最小生成树

* （定义9.30）若无向树T=(V,E')是连通无向图G=(V,E)的生成子图（顶点集相同，边集是子集），则T是G的**生成树**或**支撑树**
* （定义9.31）一个带权连通图G的所有生成树中树枝权值之和最小的生成树称为G的**最小生成树**
* **Kruskal算法**：不断从G中取出权最小的边加入到生成树中，并保证不构成回路（若构成回路则直接舍弃这条边）。添加n-1次后即可得到一棵最小生成树。
* **Prim算法**：先从V中任取一点加入到V‘中，然后从一端点在V‘另一端点在V-V'的边中选择权最小的加入到生成树中，添加n-1次即可得到一棵最小生成树。
### 哈夫曼树
* （定义9.32）给定有k个叶子的二叉树T=(V,E)，若k个叶子分别赋以非负实数权$w_1,w_2,\cdots,w_k$，则称T是**带权二叉树**。若T的k个叶子对应的层数分别是$l_1,l_2,\cdots,l_k$，则称$w(T)=\sum^k_{i=1}l_i\cdot w_i$为**带权二叉树T的权**。称有最小权的带权二叉树为**最优二叉树**，也称为**哈夫曼树**
* 哈夫曼算法：将所有带权叶子放入集合中。不断取出集合中权最小的两个节点，将两个节点用一个根节点合并，并把根节点放回集合中。一直重复直到集合中只有一个节点，该节点展开就是哈夫曼树。
!!!note
		最后根的权并不一定等于树的权
* 记哈夫曼树所有的左节点为0，右节点为1，这样每条从根节点到叶子的唯一通路对应了该叶子的唯一编码，利用该哈夫曼树就可以实现对数据的不等长编解码压缩
* 串的**前缀**是从第一个字符开始的子串（不包含本身）；**前缀码**是一个串集合，该集合内任意两元素都不互为前缀；若前缀码中的串都由两种符号组成，则其称为**二元前缀码**
!!!note
		要对不等长编码的文件进行译码，这种编码必须是前缀码，哈夫曼编码是前缀码
## 一些特殊的图
### 平面图
* （定义9.35）**可平面图**是可以给出一种画法使得任意两条边交点必然是顶点的图，这种图满足定义画法的图像就叫**平面图**
* （定义9.36）平面图的**面**或**域** R是若干边包围的、内部不包含顶点和边的区域，所有包围边组成的回路被称为该面的**边界**，回路长度被称为该面的**度**，记为deg(R)。由平面图的边包围且无穷大的面被称为平面图的**外部面**，其他面被称为**外部面**
!!!note
		面里面可以有“隔边“，隔边算两遍；环包围的区域也算面
* 平面图的所有面的度之和等于边数的两倍
* **欧拉公式**：设连通平面图G有n个顶点m条边d个面，则$n-m+d=2$
* （定理9.16）设G是连通的平面图，且G的各面度数大于或等于l，则G的边数m与顶点数n满足

$$
m\leq\frac{l}{l-2}(n-2)
$$

* （推论）定义$g(G)$是图G长度最小的回路的长度，称为图G的**围长**，若连通平面图G的围长大于等于l，则
$$
m\leq\frac{l}{l-2}(n-2)
$$
* （定义9.37）**极大平面图**是满足任意两个不相邻顶点之间加一条新边都会得到非平面图的简单平面图
* （引理9.18）：
	1. 极大平面图是连通图
	2. 极大平面图没有桥
	3. 极大平面图的每个面都有三条边组成
	4. 极大平面图面数的三倍等于边数的两倍
	5. 极大平面图的任意一个顶点与相邻顶点必构成一个回路
	6. 若极大平面图的顶点数大于等于4，则其最小度大于等于3
* （定理9.19）设极大平面图G有n个顶点m条边d个面，则$m=3n-6$且$d=2n-4$
* （推论9.20）设简单平面图G有n个顶点m条边d个面，则$m\leq3n-6$且$d\leq2n-4$
* （引理9.21）完全图$K_5$和完全二部图$K_{3,3}$都不是平面图
* （定义9.38）$K_5$和$K_{3,3}$分别记为$K^{(1)}$和$K^{(2)}$图，在$K^{(1)}$和$K^{(2)}$图上任意增加一些度数为2的顶点之后得到的图称为$K^{(1)}$和$K^{(2)}$型图，统称为K型图
* （定理9.22）**库拉图斯基定理**：图G是可平面的当且仅当G不存在K型子图
> 这只在理论上可行，实际要判断一个图是否可平面的算法比较复杂
### 欧拉图
* （定义9.39）无向连通图G的一条经过所有边的简单回路称为G的**欧拉回路**，经过所有边的简单通路称为**简单通路**；含有欧拉回路的图称为**欧拉图**，含有欧拉通路的图称为**半欧拉图**
* （定理9.23）无向连通图存在欧拉回路的充要条件是所有顶点的度数都为偶数
* （推论9.24）若无向连通图G只有两个度数为奇数的顶点，则G存在欧拉通路
* 欧拉图与一笔画问题和中国邮递员问题相关，书上有相关介绍，略
### 哈密顿图
* （定义9.40）无向图的一条经过全部顶点的初级回路称为**哈密顿回路**，经过全部顶点的初级通路称为**哈密顿通路**。存在哈密顿回路的无向图称为**哈密顿图**，存在哈密顿通路的图称为**半哈密顿图**
* （定义9.41）无向图的**极长通路**是两端点至于该通路顶点相邻的简单通路，如果他还是初级通路，则称为**极长初级通路**
* （定理9.25）如果n阶简单图G的任意两个顶点的度数之和大于或等于$n-1$，这里$n\geq 2$，则G存在哈密顿通路
> 这是充分条件，充要条件还没找到
* （推论9.26）若n（大于等于3）阶简单图G的任意两顶点读书之和大于或等于n，则G存在哈密顿回路
