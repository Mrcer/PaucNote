# 输入输出系统
## 概述
在冯诺依曼结构中，输入输出系统是用于控制外设与主存、外设与CPU之间进行数据交换的软硬件系统。

外设，也就是I/O设备，从交互方式可分为人机交互设备和机器可读设备，从操作功能可分为输入输出设备和外部存储设备。其特点为速度慢、多样性和复杂性。

## I/O接口

不同外设有不同的数据交换速度、方式、格式等等，主机也有差异，需要用I/O接口来向主机提供统一的外设形式，向外设提供统一的主机形式。具体来说，有以下功能：

1. 数据格式转换（如串并行转换）和电平变换
2. 数据缓存以协调速度
3. 给主机提供寻址功能以便主机访问
4. 向主机提供外设和接口状态
5. 实现主机对外设的控制

为了实现上述功能，I/O接口至少包含以下模块：

1. 数据寄存器
2. 状态寄存器
3. 控制寄存器
4. I/O控制逻辑模块
5. 外设界面控制逻辑

其中的各种寄存器称为I/O端口。CPU访问I/O端口需要地址，可使用统一编址或独立编址。统一编址是把I/O端口映射到主存空间区域，独立编址则单独编号。统一编址简单但稍慢，独立编址要专用I/O指令但更快。

## 磁盘存储器

磁盘的硬件主要由主轴、碟片、磁头、传动臂、步进电机组成，通过传动臂控制磁头所在半径位置，在碟片旋转到合适位置时磁头读写数据。

碟片上按磁头大小分为多个圆环，称为磁道，每个磁道划分出多个段，称为扇区，数据以磁性方向存储在扇区内。磁头是电磁线圈，通过电磁感应读写数据。

磁盘的容量由磁介质数量决定，它的密度称为面密度，可进一步分为道密度（径向密度）和位密度（切向密度）。并不是所有磁介质都用于存储有效数据，扇区间需要留有间隙便于缓冲。

存取时间可分为寻道时间、旋转等待时间、数据传输时间，前两个都是不稳定的，取平均时间。

磁盘错误分为软错误和硬错误。软错误是由于电信号干扰导致的随机错误，硬错误是由于磁介质或磁头损坏导致的永久性错误。

## Flash memory存储器

闪存是一种电可擦写、可编程只读存储器（EEPROM），可分为NOR Flash和NAND Flash。前者支持随机字节访问，读取快写入慢，主要用于存储程序代码；后者使用块级访问，读写较快，主要用于存储数据。

闪存的存储元是一块浮栅晶体管，通过浮栅中是否存入电子来区分0/1。写入是通过高电压改变浮栅状态，读取是根据低电压下浮栅旁P衬底流过电流大小来间接判断浮栅是否保存足够电子，从而区分0/1。

反复地擦写后浮栅的电子可能泄露，从而无法区分0/1，因此闪存控制芯片需要使用损耗均衡技术，控制存储芯片内的存储元磨损程度相近，从而延长寿命。

使用USB接口连接主板的闪存也就是U盘